{% extends '../base.html' %}
{% load static %}
<!-- ---------------------------------------------- -->
    {% block title %}
Create Courses
    {% endblock title %}
<!-- --------------------------------------------- -->
    {% block header %}

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<!-- Latest compiled and minified JavaScript -->
<!-- (Optional) Latest compiled and minified JavaScript translation files -->


    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" >


    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" ></script> -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

  
    <!-- <link rel="stylesheet" href="https://rawgit.com/silviomoreto/bootstrap-select/master/dist/css/bootstrap-select.css"> -->
    <!-- <script src="https://rawgit.com/silviomoreto/bootstrap-select/master/dist/js/bootstrap-select.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.18/js/bootstrap-select.min.js" ></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.18/css/bootstrap-select.min.css"  />
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.15/css/bootstrap-multiselect.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.15/js/bootstrap-multiselect.min.js" ></script> -->
    <link href="{% static 'facilitators/vendor/fontawesome-free/css/all.min.css' %}" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Raleway:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link href="css2/all.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <!-- Main Style Css --> 
    <!-- <link rel="stylesheet" href="{% static 'facilitators/css/create_course.css'%}" /> -->


    <!-- Custom styles for this template-->
    <!-- <link href="{% static 'facilitators/css/main.css'%}" rel="stylesheet"> -->
    {% endblock header %}
<!-- ------------------------------------------- -->
   
    {% block stylesheet %}
    <style>
        .bootstrap-select>.dropdown-toggle {
            border: 1px solid;
        }
        .open>.dropdown-menu {
    display: block;
        }
    .btn-group.open .dropdown-toggle {
    -webkit-box-shadow: inset 0 3px 5px rgba(0,0,0,.125);
    box-shadow: inset 0 3px 5px rgba(0,0,0,.125);
    }
    .bootstrap-select .dropdown-toggle:focus {
    outline: thin dotted #333333 !important;
    outline: 5px auto -webkit-focus-ring-color !important;
    outline-offset: -2px;
    }
    .bootstrap-select .dropdown-toggle:focus {
    outline: thin dotted #333333 !important;
    outline: 5px auto -webkit-focus-ring-color !important;
    outline-offset: -2px;
    }
    .bootstrap-select.btn-group .dropdown-menu li {
    position: relative;
        }
        .dropdown-header {
            display: block;
            padding: 3px 20px;
            font-size: 12px;
            line-height: 1.42857143;
            color: #777;
            white-space: nowrap;
        }
        #accordionSidebar {
            height: 100%;
            width: 160px;
            position: fixed;
            z-index: 1;
            top: 0;
            left: 0;
            background-color: #111;
            overflow-x: hidden;
            padding-top: 20px;
        }
        
        #topbar {
            position: fixed;
            z-index: 100;
            vertical-align: top;
            left: 224px;
        }
        .deletevid ul li{
            display: flex;
            justify-content: space-between;
        }
        .deletevid .delete-btn{
            padding: 5px 20px;
            background-color: red;
            color: #fff;
            border-radius: 5px;

        }
        a:hover{
            text-decoration: none;
        }
        /* .uploadform,.deletevid{
            display : none;
        } */
        @media only screen and (max-width: 400px) {
            #topbar {
                left: 0;
            }
            #accordionSidebar {
                top: 65px;
            }
        }
        
        @media only screen and (max-width: 767px) {
            #topbar {
                left: 0;
            }
            #accordionSidebar {
                top: 65px;
            }
            #content {
                left: auto;
               
                width: 100%;
                width: calc(100% - 0px);
            }
            .content-wrapper {
                padding:0;
            }
        }
        
        @media only screen and (max-width: 1800px) {
            #content {
                padding: 20px 30px;
            }
        }
    </style>

    {% endblock stylesheet %}
<!-- ----------------------------------------------------- -->
    {% block content %}
{% if success %}
    <script>
    swal("Created", "{{success}}", "success");
    </script>
  {% endif %}
    
  <script type="text/javascript">
    window.onload = function() {
        document.getElementById('uploadform').style.display = 'none';
        document.getElementById('deletevid').style.display = 'none';
    }
    function videoupdtdel() {
        
        if ($('#updvid').is(':checked')) {
            $('#uploadform').show();
            $('#deletevid').hide();
            // document.getElementById('dltvid').removeAttribute("checked");
            // document.getElementById('dltvid').checked = false;

        }
        else if( $('#dltvid').is(':checked')){ 
            $('#deletevid').show();
            $('#uploadform').hide();
            // document.getElementById('updvid').removeAttribute("checked");
            // document.getElementById('updvid').checked = false;
        }
        // else{
        //     document.getElementById('uploadform').style.display = 'none';
        //     document.getElementById('deletevid').style.display = 'none';
        // }
    }
    
</script>
  
     
                <!-- page content begin  -->
                
                
                <div class=" bg-white" style="position: relative;font-family: 'Raleway';  color: #000; padding: 20px 30px;" id="content">
                    <div class="container-fluid " >
                        <ul class="nav nav-tabs" id="myTab" role="tablist">
                            <li class=" nav-item active"><a class="nav-link active" href="#createcourse" data-toggle="tab" role="tab" aria-controls="createcourse" aria-selected="true">Create course</a></li>
                            <li class="nav-item"><a class="nav-link" href="#updtcrs" data-toggle="tab" role="tab" aria-controls="updtcrs" aria-selected="false">Update/Delete course</a></li>
                        </ul>
                        <div class="tab-content" id="myTabContent">
                            <div id="createcourse" class="tab-pane fade in active show" role="tabpanel" aria-labelledby="createcourse-tab">
                                <!-- <h1>Hello</h1> -->
                                
                                    <div class="container">
                                            <div>
                                                <h3 class="heading">Overview</h3>
                                                    <p>Please enter the necessary information and proceed forward for content creation. </p>
                                            </div>
                                        <form action="" method="post">
                                            <div class="form-row">
                                                <div class="form-group col-md-6">
                                                  <label for="inputEmail4">Code</label>
                                                  <input type="text" class="form-control" id="inputEmail4" placeholder="code">
                                                </div>
                                                <div class="form-group col-md-6">
                                                  <label for="inputPassword4">Title</label>
                                                  <input type="text" class="form-control" id="inputPassword4" placeholder="Title">
                                                </div>
                                              </div>
                                              <div class="form-group">
                                                <label for="inputAddress">Description</label>
                                                <input type="text" class="form-control" id="inputAddress" placeholder="Description">
                                              </div>
                                              
                                              <div class="form-row">
                                                <!-- <div class="form-group col-md-6">
                                                  <label for="inputCity">City</label>
                                                  <input type="text" class="form-control" id="inputCity">
                                                </div> -->
                                                <div class="form-group col-md-6">
                                                  <label for="inputState">Target Audience</label>
                                                  <select id="inputState" class="form-control">
                                                    {% for obj in audience_list %}
                                                                <option value="{{obj.audience}}">{{obj.audience}}</option>
                                                                {% endfor %}      
                                                  </select>
                                                </div>
                                                
                                              </div>
                                              <div class="form-row">
                                                <div class="form-group col-md-6" style="
                                                margin-top: auto;
                                                margin-bottom: auto;
                                            ">
                                              
                                                <select class="selectpicker " title="Choose Your Course" name="course" id="category" multiple style="width: 100%;">

                                                    {% for cat in category %}
                                                    <optgroup label="{{cat.name}}">
                                                        {% for sub in subcategory %}
                                                        {% if sub.cat_id.cat_id == cat.cat_id %}
                                                        <option value="{{sub.subCat_id}}">{{sub.name}}</option>
                                                        {% endif %}
                                                    {% endfor %}
                                                    </optgroup>
                                                    {% endfor %}
                                                
                                                </select>
                                                </div>
                                                <div class="form-group col-md-6">
                                                    <label for="exampleFormControlFile1">Upload</label>
                                                    <input type="file" class="form-control-file" id="exampleFormControlFile1">
                                                </div>
                                            </div>
                                               <div class="form-group">
                                                            <label for="exampleFormControlTextarea1">Takeaway/Learning</label>
                                                            <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
                                                </div>
                                              <button type="submit" class="btn btn-primary">Submit</button>

                                        </form>
                                    </div>
                                
                            </div>
                            <div id="updtcrs" class="tab-pane fade in " role="tabpanel" aria-labelledby="updtcrs-tab">
                                <!-- <h1>Hello world</h1> -->
                                <div class="mt-3" >
                                <form action="" method="post">
                                    <div class="form-group ">
                                        <label for="inputEmail4">Course Code</label>
                                        <input type="text" class="form-control" id="inputEmail4" placeholder="code">
                                    </div>
                                    <div class="form-group">
                                        <input class="" type="radio" name="updvid" id="updvid" value="update" onclick="videoupdtdel()" >
                                        <label class="form-check-label" for="exampleRadios1">
                                         Update
                                        </label>
                                      </div>
                                    <div class="form-group">
                                        <input class="" type="radio" name="updvid" id="dltvid" value="delete"  onclick="videoupdtdel()" >
                                        <label class="form-check-label" for="exampleRadios1">
                                          Delete
                                        </label>
                                    </div>
                                    </div>
                                </form>
                                <div class="uploadform mt-3" id="uploadform">
                                    <h2>Upload A video</h2>
                                    <form action="" method="post">
                                        <div class="form-group ">
                                            <label for="inputEmail4">Title</label>
                                            <input type="text" class="form-control" id="inputEmail4" placeholder="Title">
                                        </div>
                                        <div class="form-group">
                                            <label for="inputAddress">Description</label>
                                            <input type="text" class="form-control" id="inputAddress" placeholder="Description">
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group col-md-6">
                                                <label for="exampleFormControlFile1">Upload Video</label>
                                                <input type="file" class="form-control-file" id="exampleFormControlFile1" name="videoup">
                                            </div>
                                            <div class="form-group col-md-6">
                                                <label for="exampleFormControlFile1">Upload Thumbnail</label>
                                                <input type="file" class="form-control-file" id="exampleFormControlFile1" name="thumbailup">
                                            </div>
                                        </div>
                                            <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="coursevid">
                                            <label class="form-check-label" for="inlineCheckbox1">Course Video</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="livevid">
                                            <label class="form-check-label" for="inlineCheckbox2">Live Video</label>
                                        </div>
                                        <div class="form-group mt-3">
                                            <button type="submit" class="btn btn-primary">Submit</button>
                                        </div>
                                        
                                    </form>
                                </div>
                                <div class="deletevid" id="deletevid">
                                    <ul class="list-group">
                                        <li class="list-group-item">Video 1 : <a href="" class="delete-btn"> Delete</a> </li>
                                        <li class="list-group-item">Video 2 : <a href="" class="delete-btn"> Delete</a> </li>
                                        <li class="list-group-item">Video 3 : <a href="" class="delete-btn"> Delete</a> </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
               

                <!-- page content end  -->
                </div>


              
            </div>
        </div>
        <!-- End of Footer -->

    </div>
    <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

     <!-- <script src="{% static 'facilitators/vendor/jquery/jquery.min.js'%}"></script> -->
    <script src="{% static 'facilitators/vendor/bootstrap/js/bootstrap.bundle.min.js'%}"></script>

    <!-- Core plugin JavaScript-->
    <script src="{% static 'facilitators/vendor/jquery-easing/jquery.easing.min.js'%}"></script>
    

    <!-- Custom scripts for all pages-->
    <script src="{% static 'facilitators/js/sb-admin-2.min.js'%}"></script>

    <!-- Page level plugins -->
    <script src="{% static 'facilitators/vendor/chart.js/Chart.min.js'%}"></script>

    <!-- Page level custom scripts -->
    <script src="{% static 'facilitators/js/demo/chart-area-demo.js'%}"></script>
    <script src="{% static 'facilitators/js/demo/chart-pie-demo.js'%}"></script>


    
   
  
    

{% endblock content %}

{% block javascript %}
 <script>
 
    $(document).ready(function(){
  
    var $myForm = $('#msform')
    $("#finish").click(function(event){
        event.preventDefault()  
         var cat_list = $('#category option:selected').toArray().map(item => item.text);      
    var session= 'false'//document.getElementById('session').getAttribute('aria-selected');
   var course= 'true'//document.getElementById('course').getAttribute('aria-selected');
   var coursevideo;
   var sessionvideo;
   var $video;
   var data = {};
   var course_details={
       "code":$('#id_code').val(),
       "title":$('#id_title').val(),
       "description":$('#id_description').val(),
       "audience":$('#id_audience').val(),
       "takeway":$('#id_takeway').val(),
        "days":$('#cdays').val(),
        "months":$('#cmonths').val()
 
   };
   if(course=='true')
   {
        coursevideo={
                "title":$('#ctitle').val(),
                "description":$('#cdescription').val(),
                "session_duration":$('#ctime').val()
               }
        $video=$('#coursevideo').get(0).files[0];
data={
    "rvideo":"true",
    "svideo":"false",
    "video":coursevideo,
    "course":course_details,
    "subcategory":cat_list
}
   }
   else {
sessionvideo={
               "title":$('#stime').val(),
                "description":$('#sdescription').val(),
                "session_duration":$('#ltime').val(),
                "session_start":$('#lstime').val(),
                "session_end":$('#letime').val(),
                "date":$('#ldate').val(),
                "days":$('#ldays').val()

       
       }

 $video=$('#livevideo').get(0).files[0]

 data={
    "rvideo":"false",
    "svideo":"true",
    "video":sessionvideo,
    "course":course_details,
    "subcategory":cat_list
}
   }


console.log(data);

var formData = new FormData();
  formData.append('file',$video)
  formData.append('data',JSON.stringify(data))

 $.ajaxSetup({async: false});
$.ajax({
    url: "{% url 'createcourseapi' %}",
    async: false,
    data: formData,
    contentType: false,
    processData: false,
    headers: {
                        "X-CSRFTOKEN": "{{ csrf_token }}"
                },
    type: 'POST',
    cache: false,
    
    error: function(xhr, status, error) {
        alert(error);
    },
    success: function(response) {
        
    swal("Done!", "Course is Created Successfully ", "success");
      setTimeout(function(){
            window.location.href = '{% url "createcourse" %}';
         }, 5000); 
                
            
    }
});

$.ajaxSetup({async: true}); 

});
});

    // Material Select Initialization

        // Add the following code if you want the name of the file appear on select
       

         $(".custom-file-input").on("change", function() {
        var fileName = $(this).val().split("\\").pop();
        $(this).siblings(".custom-file-label").addClass("selected").html(fileName);
        });

        {% comment %} var colors = ['1abc9c', '2c3e50', '2980b9', '7f8c8d', 'f1c40f', 'd35400', '27ae60'];

        colors.each(function(color) {
            $$('.color-picker')[0].insert(
                '<div class="square" style="background: #' + color + '"></div>'
            );
        });

        $$('.color-picker')[0].on('click', '.square', function(event, square) {
            background = square.getStyle('background');
            $$('.custom-dropdown select').each(function(dropdown) {
                dropdown.setStyle({
                    'background': background
                });
            });
        });  {% endcomment %}
    </script>
     <script>
      
        $("#finish").click(function() {
        alert( "Handler for .click() called." );
        });
            
    </script>
        <script>
                $("li").on('click', function(){
            var base 		= $(this).closest(".bootstrap-select");
            var select 	= base.find("select");
    
            if(base.length && select.prop("multiple")){ // check if this .dropdown-header is part of bootstrap-select AND multiple or not
    
                var group 	= $(this).data("optgroup")-1;
                var group2 	= group+1;
                var select 	= $(this).closest(".bootstrap-select").find("select");
    
                if($(this).hasClass("dropdown-header")){
    
                    if(base.find("li[data-optgroup=" + group2 + "]:not(.selected)").length === 1)
                        $(this).closest(".bootstrap-select").find("select > optgroup:eq(" + group + ") > option").prop("selected",false);
                    else
                        $(this).closest(".bootstrap-select").find("select > optgroup:eq(" + group + ") > option").prop("selected",true);
    
                    select.selectpicker('render');
                    var rs 	= select.mySelect();
                    $(".result").text(rs);
    
                }else{
                    setTimeout(function() { // set timeout because waiting for some bootstrap-select event done.
                        var rs 	= select.mySelect();
                        $(".result").text(rs);
                    }, 100);
                }
            }else{
                $(".result").text("not a bootstrap-select");
            }
        });
    
        /* function onchange */
        $.fn.mySelect = function(){ 
            var arr = new Array();
            $(this).find("option").each(function()
            {
                if($(this).is(":selected"))
                {             
                    id = $(this).attr("id");
                    class_dept = $(this).attr("class");
                    if(id == class_dept){
                        //do something
                    }
    
                    if(arr.indexOf(id) == -1)
                    {
                        arr.push(id); 
                    }
                }
                else
                {
                    id = $(this).attr("id");
                    arr = jQuery.grep(arr, function(value) {
                        return value != id;
                    });             
                }
            });
    
            return "Last selected : " + arr[arr.length-1] +" | array_item:"+ arr;
    
        }
        </script>
{% endblock javascript%}
